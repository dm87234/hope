import{_ as W,o as d,c as V,a as f,z as Z,r as u,f as b,w as t,t as w,n as ee,b as e,l as J,v as de,e as _,k as K,F as Q,E as v,d as o,q as te,A as ae,C as oe,p as me,g as _e,y as fe}from"./index-Bo4242gt.js";import{b as pe,e as ve,g as ge,c as ye,a as Ce,d as ke}from"./category-lSE33_bX.js";import{g as be,b as we}from"./user-CRazH6ID.js";import"./request-tU5QKqId.js";const Ve={},Ee={class:"categoryContainer"},Ie={class:"categoryItem"},he={class:"emoji"};function je(p,s){return d(),V("div",Ee,[f("div",Ie,[f("div",he,[Z(p.$slots,"emoji",{},void 0,!0)]),f("div",null,[Z(p.$slots,"cateName",{},void 0,!0)])])])}const le=W(Ve,[["render",je],["__scopeId","data-v-4af41f54"]]),xe=["id"],Ne=["onClick"],Ae={class:"dialog-footer"},Pe={__name:"CateEdit",props:{AllEmoji:Array},emits:["success"],setup(p,{expose:s,emit:E}){const y=u(!1),n=u({id:"",categoryName:"",statusCode:"0",categoryPic:""}),I=p,g=u(""),R=(m,r)=>{g.value=m,n.value.categoryPic=r},P=E,T=async()=>{if(!n.value.categoryName)return v.error("請輸入類別名稱");if(!n.value.categoryPic)return v.error("請選擇一個圖案");if(n.value.id){const{data:m}=await ve(n.value);m.status!==0&&v.error("編輯類別失敗"),v.success("編輯類別成功")}else{const{data:m}=await pe(n.value);m.status!==0&&v.error("新增類別失敗"),v.success("新增類別成功")}y.value=!1,g.value="",n.value={categoryName:"",statusCode:"0",categoryPic:""},P("success")},h=m=>{Object.keys(m).length!==0&&(n.value={...m},g.value=m.categoryPic),y.value=!0},U=()=>{n.value={categoryName:"",statusCode:"0",categoryPic:""},g.value="",y.value=!1};return s({open:h}),(m,r)=>{const $=o("el-icon"),j=o("el-option"),q=o("el-select"),x=o("el-form-item"),C=o("el-col"),N=o("el-input"),A=o("el-row"),B=o("el-card"),M=o("el-form"),S=o("el-button"),L=o("el-dialog");return d(),b(L,{modelValue:y.value,"onUpdate:modelValue":r[3]||(r[3]=c=>y.value=c),onClose:U,width:"370","show-close":!1,style:{"background-color":"#fff8f1","border-radius":"8px"}},{header:t(({close:c,titleId:k,titleClass:z})=>[f("h4",{id:k,class:ee(z)},w(n.value.id?"編輯類別":"新增類別"),11,xe),e($,{onClick:c,color:"#F56C6C",size:"24",style:{cursor:"pointer"}},{default:t(()=>[e(J(de))]),_:2},1032,["onClick"])]),footer:t(()=>[f("div",Ae,[e(S,{onClick:r[2]||(r[2]=c=>T()),type:"primary",style:{width:"100px"}},{default:t(()=>[_("確認")]),_:1}),e(S,{onClick:U,type:"primary",style:{width:"100px"}},{default:t(()=>[_("取消")]),_:1})])]),default:t(()=>[e(M,null,{default:t(()=>[e(A,{gutter:20},{default:t(()=>[e(C,{span:7},{default:t(()=>[e(x,null,{default:t(()=>[e(q,{"fit-input-width":"",modelValue:n.value.statusCode,"onUpdate:modelValue":r[0]||(r[0]=c=>n.value.statusCode=c),disabled:!!n.value.id},{default:t(()=>[e(j,{label:"支出",value:"0"}),e(j,{label:"收入",value:"1"})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),e(C,{span:17},{default:t(()=>[e(x,null,{default:t(()=>[e(N,{modelValue:n.value.categoryName,"onUpdate:modelValue":r[1]||(r[1]=c=>n.value.categoryName=c),autocomplete:"off",placeholder:"請輸入類別名稱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(B,{class:"box-card",shadow:"never"},{default:t(()=>[(d(!0),V(Q,null,K(I.AllEmoji,(c,k)=>(d(),V("span",{onClick:z=>R(k,c.emoji),key:k,class:ee(["emojiItem",{active:g.value===k||g.value===c.emoji}])},w(c.emoji),11,Ne))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Ue=W(Pe,[["__scopeId","data-v-cf176b3e"]]),se=p=>(me("data-v-a0f44568"),p=p(),_e(),p),$e={class:"settings_container m50"},Be={class:"top"},Se=se(()=>f("h3",{class:"title"},"個人資料設定",-1)),Le={class:"bottom"},ze=se(()=>f("h3",{class:"title"},"分類設定",-1)),Oe={style:{"text-align":"center"}},Fe={__name:"index",setup(p){const s=u({nickname:"",email:""}),E=u([]),y=te(()=>E.value.filter(a=>a.statusCode==="0")),n=te(()=>E.value.filter(a=>a.statusCode==="1")),I=u(!1),g=()=>{I.value=!0},R=async()=>{const a=await L(s.value);console.log(a),I.value=!1},P=u(null),T={email:[{required:!0,message:"請輸入電子信箱",trigger:"blur"},{type:"email",message:"電子信箱不正確",trigger:"blur"}]},h=u(!1),U=()=>{h.value=!0},m=async()=>{await P.value.validate();const a=await L(s.value);console.log(a),h.value=!1},r=u([]),$=u(null),j=a=>{a===0&&(C.value={}),$.value.open(C.value)},q=u(null),x=()=>{A.value=!1},C=u({}),N=u(null),A=u(!1),B=(a,i)=>{a.target.classList[0]!=="categoryItem"?N.value=a.target.parentNode:N.value=a.target,A.value=!0,C.value=i},M=async()=>{fe.confirm("確定要刪除此類別嗎?",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{data:a}=await ke(C.value.id);a.status!==0&&v.error("刪除類別失敗"),v.success("刪除類別成功"),c()}).catch(()=>{})},S=async()=>{const{data:{data:a}}=await be();s.value.nickname=a.nickname,s.value.email=a.email},L=async()=>{const a=await we(s.value);console.log(a)},c=async()=>{const{data:a}=await ge();if(a.status!==0)return v.error("服務異常");E.value=a.data},k=async()=>{const{data:{data:a}}=await ye();r.value=a},z=()=>{c()};return S(),c(),k(),(a,i)=>{const O=o("el-input"),F=o("font-awesome-icon"),D=o("el-form-item"),X=o("el-col"),ne=o("el-row"),ce=o("el-form"),G=o("el-button"),ie=o("el-card"),Y=o("el-tab-pane"),ue=o("el-tabs"),re=o("el-popover");return d(),V("div",$e,[f("div",Be,[Se,e(ie,{shadow:"never"},{default:t(()=>[e(ce,{"label-position":"top",model:s.value,rules:T,ref_key:"form",ref:P},{default:t(()=>[e(ne,{gutter:20},{default:t(()=>[e(X,{xs:24,span:12},{default:t(()=>[I.value?(d(),b(D,{key:1,label:"暱稱"},{default:t(()=>[e(O,{modelValue:s.value.nickname,"onUpdate:modelValue":i[1]||(i[1]=l=>s.value.nickname=l),maxlength:"10"},null,8,["modelValue"]),e(F,{icon:["fas","circle-check"],onClick:R})]),_:1})):(d(),b(D,{key:0,label:"暱稱"},{default:t(()=>[e(O,{modelValue:s.value.nickname,"onUpdate:modelValue":i[0]||(i[0]=l=>s.value.nickname=l),disabled:"",placeholder:"請輸入暱稱(限10字)"},null,8,["modelValue"]),e(F,{icon:["fas","pencil"],onClick:g})]),_:1}))]),_:1}),e(X,{xs:24,span:12},{default:t(()=>[h.value?(d(),b(D,{key:1,label:"電子信箱",prop:"email"},{default:t(()=>[e(O,{modelValue:s.value.email,"onUpdate:modelValue":i[3]||(i[3]=l=>s.value.email=l),maxlength:"100"},null,8,["modelValue"]),e(F,{icon:["fas","circle-check"],onClick:m})]),_:1})):(d(),b(D,{key:0,label:"電子信箱"},{default:t(()=>[e(O,{modelValue:s.value.email,"onUpdate:modelValue":i[2]||(i[2]=l=>s.value.email=l),disabled:""},null,8,["modelValue"]),e(F,{icon:["fas","pencil"],onClick:U})]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"]),e(G,{class:"resetPwdBtn",type:"danger"},{default:t(()=>[_("重置密碼")]),_:1})]),_:1})]),f("div",Le,[ze,e(ue,{type:"border-card"},{default:t(()=>[e(Y,{label:"支出類別"},{default:t(()=>[(d(!0),V(Q,null,K(y.value,l=>ae((d(),b(le,{key:l.id,onClick:H=>B(H,l)},{emoji:t(()=>[_(w(l.categoryPic),1)]),cateName:t(()=>[_(w(l.categoryName),1)]),_:2},1032,["onClick"])),[[J(oe),x]])),128))]),_:1}),e(Y,{label:"收入類別"},{default:t(()=>[(d(!0),V(Q,null,K(n.value,l=>ae((d(),b(le,{key:l.id,onClick:H=>B(H,l)},{emoji:t(()=>[_(w(l.categoryPic),1)]),cateName:t(()=>[_(w(l.categoryName),1)]),_:2},1032,["onClick"])),[[J(oe),x]])),128))]),_:1}),e(Ce,{onClick:i[4]||(i[4]=l=>j(0))},{default:t(()=>[_("新增類別")]),_:1})]),_:1})]),e(Ue,{ref_key:"dialog",ref:$,AllEmoji:r.value,onSuccess:z},null,8,["AllEmoji"]),e(re,{ref_key:"popoverRef",ref:q,visible:A.value,"virtual-ref":N.value,trigger:"click","virtual-triggering":""},{default:t(()=>[f("div",Oe,[e(G,{onClick:i[5]||(i[5]=l=>j(1)),type:"success",size:"small"},{default:t(()=>[_("編輯")]),_:1}),e(G,{onClick:M,type:"danger",size:"small"},{default:t(()=>[_("刪除")]),_:1})])]),_:1},8,["visible","virtual-ref"])])}}},Me=W(Fe,[["__scopeId","data-v-a0f44568"]]);export{Me as default};
